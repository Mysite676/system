<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Damar Enterprise - Loan Application</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #2e8b57;
            --primary-dark: #1f6b3d;
            --secondary-color: #1e90ff;
            --accent-color: #ff4757;
            --success-color: #2ecc71;
            --warning-color: #f39c12;
            --danger-color: #e74c3c;
            --light-color: #f8f9fa;
            --dark-color: #212529;
            --bg-color: #f8f9fa;
            --card-bg: #ffffff;
            --text-color: #343a40;
            --text-light: #6c757d;
            --border-color: #e9ecef;
            --shadow-sm: 0 1px 2px rgba(0,0,0,0.05);
            --shadow: 0 4px 6px rgba(0,0,0,0.1);
            --shadow-md: 0 10px 15px rgba(0,0,0,0.1);
            --shadow-lg: 0 20px 25px rgba(0,0,0,0.1);
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            --radius-sm: 0.25rem;
            --radius: 0.5rem;
            --radius-lg: 0.75rem;
            --radius-xl: 1rem;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', sans-serif;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            line-height: 1.6;
            font-size: 16px;
            -webkit-text-size-adjust: 100%;
        }

        .container {
            width: 100%;
            max-width: 500px;
            margin: 0 auto;
            padding: 15px;
            min-height: 100vh;
        }

        .header {
            text-align: center;
            margin-bottom: 20px;
            padding: 15px 0;
        }

        .logo {
            width: 70px;
            height: 70px;
            margin: 0 auto 10px;
            border-radius: 50%;
            background-color: rgba(46, 139, 87, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            color: var(--primary-color);
        }

        .header h1 {
            color: var(--primary-color);
            font-size: 22px;
            margin-bottom: 5px;
        }

        .header p {
            color: var(--text-light);
            font-size: 14px;
        }

        .progress-bar {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            position: relative;
        }

        .progress-bar::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 2px;
            background-color: var(--border-color);
            z-index: 1;
            transform: translateY(-50%);
        }

        .progress-step {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background-color: var(--border-color);
            color: var(--text-light);
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            z-index: 2;
            font-weight: 500;
        }

        .progress-step.active {
            background-color: var(--primary-color);
            color: white;
        }

        .progress-step.completed {
            background-color: var(--success-color);
            color: white;
        }

        .form-container {
            background-color: var(--card-bg);
            border-radius: var(--radius-lg);
            padding: 20px;
            box-shadow: var(--shadow);
            margin-bottom: 20px;
        }

        .form-step {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .form-step.active {
            display: block;
        }

        .form-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: var(--text-color);
            font-size: 14px;
        }

        input, select, textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--border-color);
            border-radius: var(--radius-sm);
            font-size: 15px;
            transition: var(--transition);
            background-color: var(--card-bg);
            color: var(--text-color);
        }

        input:focus, select:focus, textarea:focus {
            border-color: var(--primary-color);
            outline: none;
            box-shadow: 0 0 0 3px rgba(46, 139, 87, 0.2);
        }

        .radio-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 10px;
        }

        .radio-option {
            display: flex;
            align-items: center;
            padding: 10px;
            border-radius: var(--radius-sm);
            border: 1px solid var(--border-color);
            transition: var(--transition);
            cursor: pointer;
        }

        .radio-option:hover {
            border-color: var(--primary-color);
        }

        .radio-option input {
            width: auto;
            margin-right: 10px;
        }

        .form-actions {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }

        .btn {
            padding: 12px 20px;
            border-radius: var(--radius);
            font-weight: 500;
            cursor: pointer;
            border: none;
            transition: var(--transition);
            font-size: 15px;
            text-align: center;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
            color: white;
            box-shadow: var(--shadow-sm);
        }

        .btn-primary:hover {
            opacity: 0.9;
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }

        .btn-outline {
            background: transparent;
            border: 1px solid var(--primary-color);
            color: var(--primary-color);
        }

        .btn-outline:hover {
            background: var(--primary-color);
            color: white;
        }

        .error-message {
            color: var(--danger-color);
            margin-top: 5px;
            font-size: 13px;
            display: none;
        }

        .terms-container {
            max-height: 200px;
            overflow-y: auto;
            border: 1px solid var(--border-color);
            padding: 15px;
            border-radius: var(--radius-sm);
            margin-bottom: 15px;
            font-size: 13px;
            line-height: 1.6;
        }

        .terms-container h3 {
            margin-bottom: 10px;
            color: var(--primary-color);
        }

        .terms-container p {
            margin-bottom: 10px;
        }

        .checkbox-group {
            display: flex;
            align-items: flex-start;
            margin-top: 15px;
        }

        .checkbox-group input {
            width: auto;
            margin-right: 10px;
            margin-top: 3px;
        }

        .checkbox-group label {
            font-weight: normal;
            margin-bottom: 0;
        }

        .confirmation-message {
            text-align: center;
            padding: 20px;
        }

        .confirmation-message i {
            font-size: 50px;
            color: var(--success-color);
            margin-bottom: 15px;
        }

        .confirmation-message h2 {
            margin-bottom: 10px;
            color: var(--primary-color);
        }

        .confirmation-message p {
            color: var(--text-light);
            margin-bottom: 20px;
        }

        .login-container {
            display: flex;
            flex-direction: column;
            justify-content: center;
            min-height: 100vh;
            padding: 20px;
        }

        .login-card {
            background-color: var(--card-bg);
            border-radius: var(--radius-lg);
            padding: 25px;
            box-shadow: var(--shadow-lg);
            width: 100%;
            max-width: 400px;
            margin: 0 auto;
            text-align: center;
            border-top: 5px solid var(--primary-color);
        }

        .login-card h2 {
            color: var(--primary-color);
            margin-bottom: 15px;
            font-size: 22px;
        }

        .login-form .form-group {
            margin-bottom: 15px;
            text-align: left;
        }

        .login-btn {
            width: 100%;
            padding: 12px;
            background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
            color: white;
            border: none;
            border-radius: var(--radius);
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
            margin-top: 10px;
        }

        .login-btn:hover {
            opacity: 0.9;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @media (max-width: 480px) {
            .container {
                padding: 10px;
            }
            
            .form-container {
                padding: 15px;
            }
            
            .btn {
                padding: 10px 15px;
                font-size: 14px;
            }
            
            input, select, textarea {
                padding: 10px;
                font-size: 14px;
            }
        }
    </style>
</head>
<body>
    <!-- Login Screen -->
    <div class="login-container" id="loginScreen">
        <div class="login-card">
            <div class="logo">
                <i class="fas fa-hand-holding-usd"></i>
            </div>
            <h2>Loan Application Portal</h2>
            <form class="login-form" id="loginForm">
                <div class="form-group">
                    <label for="adminUsername">Admin Username</label>
                    <input type="text" id="adminUsername" placeholder="Enter admin username" required>
                </div>
                <div class="form-group">
                    <label for="adminPassword">Admin Password</label>
                    <input type="password" id="adminPassword" placeholder="Enter admin password" required>
                </div>
                <div class="error-message" id="loginError">
                    Invalid username or password
                </div>
                <button type="submit" class="login-btn">
                    <i class="fas fa-sign-in-alt"></i> Continue as Admin
                </button>
            </form>
            <div style="margin-top: 20px; text-align: center;">
                <p>Are you a borrower? <a href="#" id="startApplication" style="color: var(--primary-color); font-weight: 500;">Start Application</a></p>
            </div>
        </div>
    </div>

    <!-- Application Form (hidden initially) -->
    <div class="container" id="applicationForm" style="display: none;">
        <div class="header">
            <div class="logo">
                <i class="fas fa-hand-holding-usd"></i>
            </div>
            <h1>Loan Application</h1>
            <p>Fill in your details to apply for a loan</p>
        </div>

        <div class="progress-bar">
            <div class="progress-step active" id="step1">1</div>
            <div class="progress-step" id="step2">2</div>
            <div class="progress-step" id="step3">3</div>
            <div class="progress-step" id="step4">4</div>
        </div>

        <div class="form-container">
            <!-- Step 1: Personal Information -->
            <div class="form-step active" id="step-1">
                <h2 style="margin-bottom: 15px; color: var(--primary-color); font-size: 18px;">Personal Information</h2>
                <div class="form-group">
                    <label for="firstName">First Name</label>
                    <input type="text" id="firstName" required>
                </div>
                <div class="form-group">
                    <label for="lastName">Last Name</label>
                    <input type="text" id="lastName" required>
                </div>
                <div class="form-group">
                    <label for="nrc">NRC Number</label>
                    <input type="text" id="nrc" placeholder="e.g. 123456/78/9" required>
                </div>
                <div class="form-group">
                    <label for="phone">Phone Number</label>
                    <input type="tel" id="phone" placeholder="e.g. 0971234567" required>
                </div>
                <div class="form-group">
                    <label for="email">Email Address (Optional)</label>
                    <input type="email" id="email" placeholder="your@email.com">
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-outline" id="nextBtn1">
                        Next <i class="fas fa-arrow-right"></i>
                    </button>
                </div>
            </div>

            <!-- Step 2: Loan Details -->
            <div class="form-step" id="step-2">
                <h2 style="margin-bottom: 15px; color: var(--primary-color); font-size: 18px;">Loan Details</h2>
                <div class="form-group">
                    <label for="loanAmount">Loan Amount (ZMW)</label>
                    <input type="number" id="loanAmount" min="100" value="1000" required>
                </div>
                <div class="form-group">
                    <label for="loanPurpose">Purpose of Loan</label>
                    <select id="loanPurpose" required>
                        <option value="">Select Purpose</option>
                        <option value="Business">Business</option>
                        <option value="Medical">Medical</option>
                        <option value="Education">Education</option>
                        <option value="Personal">Personal</option>
                        <option value="Other">Other</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Repayment Period</label>
                    <div class="radio-group">
                        <label class="radio-option">
                            <input type="radio" name="repaymentPeriod" value="7" checked> 
                            1 Week
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="repaymentPeriod" value="14"> 
                            2 Weeks
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="repaymentPeriod" value="21"> 
                            3 Weeks
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="repaymentPeriod" value="28"> 
                            4 Weeks
                        </label>
                    </div>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-outline" id="prevBtn2">
                        <i class="fas fa-arrow-left"></i> Previous
                    </button>
                    <button type="button" class="btn btn-primary" id="nextBtn2">
                        Next <i class="fas fa-arrow-right"></i>
                    </button>
                </div>
            </div>

            <!-- Step 3: Address & Employment -->
            <div class="form-step" id="step-3">
                <h2 style="margin-bottom: 15px; color: var(--primary-color); font-size: 18px;">Address & Employment</h2>
                <div class="form-group">
                    <label for="address">Residential Address</label>
                    <input type="text" id="address" placeholder="House #, Street, Area" required>
                </div>
                <div class="form-group">
                    <label for="city">City/Town</label>
                    <input type="text" id="city" required>
                </div>
                <div class="form-group">
                    <label for="employmentStatus">Employment Status</label>
                    <select id="employmentStatus" required>
                        <option value="">Select Status</option>
                        <option value="Employed">Employed</option>
                        <option value="Self-Employed">Self-Employed</option>
                        <option value="Unemployed">Unemployed</option>
                        <option value="Student">Student</option>
                    </select>
                </div>
                <div class="form-group" id="employerGroup">
                    <label for="employer">Employer/Business Name</label>
                    <input type="text" id="employer">
                </div>
                <div class="form-group" id="incomeGroup">
                    <label for="monthlyIncome">Monthly Income (ZMW)</label>
                    <input type="number" id="monthlyIncome" min="0">
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-outline" id="prevBtn3">
                        <i class="fas fa-arrow-left"></i> Previous
                    </button>
                    <button type="button" class="btn btn-primary" id="nextBtn3">
                        Next <i class="fas fa-arrow-right"></i>
                    </button>
                </div>
            </div>

            <!-- Step 4: Terms & Confirmation -->
            <div class="form-step" id="step-4">
                <h2 style="margin-bottom: 15px; color: var(--primary-color); font-size: 18px;">Terms & Conditions</h2>
                <div class="terms-container">
                    <h3>Loan Agreement Terms</h3>
                    <p>1. By applying for this loan, you agree to repay the full amount plus any applicable interest by the due date.</p>
                    <p>2. Late payments will incur a penalty fee of 10% of the outstanding amount.</p>
                    <p>3. The lender reserves the right to take legal action for non-payment.</p>
                    <p>4. You certify that all information provided is accurate and complete.</p>
                    <p>5. The lender may verify the information provided with third parties.</p>
                    <p>6. Approval of the loan is at the sole discretion of the lender.</p>
                    <p>7. Interest rates are as follows: 16% for 1 week, 20% for 2 weeks, 25% for 3 weeks, 30% for 4 weeks.</p>
                </div>
                <div class="checkbox-group">
                    <input type="checkbox" id="agreeTerms" required>
                    <label for="agreeTerms">I have read and agree to the terms and conditions</label>
                </div>
                <div class="checkbox-group">
                    <input type="checkbox" id="consent" required>
                    <label for="consent">I consent to the processing of my personal information</label>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-outline" id="prevBtn4">
                        <i class="fas fa-arrow-left"></i> Previous
                    </button>
                    <button type="button" class="btn btn-primary" id="submitBtn">
                        <i class="fas fa-paper-plane"></i> Submit Application
                    </button>
                </div>
            </div>

            <!-- Confirmation Screen -->
            <div class="form-step" id="confirmation-screen">
                <div class="confirmation-message">
                    <i class="fas fa-check-circle"></i>
                    <h2>Application Submitted!</h2>
                    <p>Thank you for applying. Your application has been received and is under review. We will contact you shortly.</p>
                    <button type="button" class="btn btn-primary" id="newApplicationBtn">
                        <i class="fas fa-plus"></i> Start New Application
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <script>
        // Firebase configuration (same as admin dashboard)
        const firebaseConfig = {
            apiKey: "AIzaSyALIYbilBnKvf5EwFJ9_JdwofUWmLwydW0",
            authDomain: "damar-loan-system.firebaseapp.com",
            databaseURL: "https://damar-loan-system-default-rtdb.firebaseio.com",
            projectId: "damar-loan-system",
            storageBucket: "damar-loan-system.firebasestorage.app",
            messagingSenderId: "192493023896",
            appId: "1:192493023896:web:ca8259d856c73ff0ee96ed",
            measurementId: "G-EJ74D1G9WK"
        };

        // Initialize Firebase
        if (!firebase.apps.length) {
            firebase.initializeApp(firebaseConfig);
        }
        const database = firebase.database();

        // Admin credentials
        const ADMIN_USERNAME = "admin";
        const ADMIN_PASSWORD = "Damar12345";

        // Current step tracking
        let currentStep = 1;
        const totalSteps = 4;

        // Format currency
        function formatCurrency(amount) {
            return `ZMW ${parseFloat(amount).toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g, ",")}`;
        }

        // Calculate due date
        function calculateDueDate(daysToAdd) {
            const today = new Date();
            const dueDate = new Date(today);
            dueDate.setDate(today.getDate() + parseInt(daysToAdd));
            return dueDate.toLocaleDateString('en-GB');
        }

        // Show error message
        function showError(element, message) {
            const errorElement = document.getElementById(element);
            errorElement.textContent = message;
            errorElement.style.display = 'block';
        }

        // Hide error message
        function hideError(element) {
            document.getElementById(element).style.display = 'none';
        }

        // Validate step 1
        function validateStep1() {
            const firstName = document.getElementById('firstName').value.trim();
            const lastName = document.getElementById('lastName').value.trim();
            const nrc = document.getElementById('nrc').value.trim();
            const phone = document.getElementById('phone').value.trim();

            if (!firstName) {
                showError('loginError', 'Please enter your first name');
                return false;
            }
            if (!lastName) {
                showError('loginError', 'Please enter your last name');
                return false;
            }
            if (!nrc) {
                showError('loginError', 'Please enter your NRC number');
                return false;
            }
            if (!phone || phone.length < 9 || phone.length > 12) {
                showError('loginError', 'Please enter a valid phone number (9-12 digits)');
                return false;
            }

            hideError('loginError');
            return true;
        }

        // Validate step 2
        function validateStep2() {
            const loanAmount = document.getElementById('loanAmount').value;
            const loanPurpose = document.getElementById('loanPurpose').value;

            if (!loanAmount || parseFloat(loanAmount) < 100) {
                showError('loginError', 'Minimum loan amount is ZMW 100');
                return false;
            }
            if (!loanPurpose) {
                showError('loginError', 'Please select a loan purpose');
                return false;
            }

            hideError('loginError');
            return true;
        }

        // Validate step 3
        function validateStep3() {
            const address = document.getElementById('address').value.trim();
            const city = document.getElementById('city').value.trim();
            const employmentStatus = document.getElementById('employmentStatus').value;

            if (!address) {
                showError('loginError', 'Please enter your address');
                return false;
            }
            if (!city) {
                showError('loginError', 'Please enter your city/town');
                return false;
            }
            if (!employmentStatus) {
                showError('loginError', 'Please select your employment status');
                return false;
            }

            hideError('loginError');
            return true;
        }

        // Validate step 4
        function validateStep4() {
            const agreeTerms = document.getElementById('agreeTerms').checked;
            const consent = document.getElementById('consent').checked;

            if (!agreeTerms) {
                showError('loginError', 'You must agree to the terms and conditions');
                return false;
            }
            if (!consent) {
                showError('loginError', 'You must consent to data processing');
                return false;
            }

            hideError('loginError');
            return true;
        }

        // Update progress steps
        function updateProgressSteps() {
            for (let i = 1; i <= totalSteps; i++) {
                const stepElement = document.getElementById(`step${i}`);
                if (i < currentStep) {
                    stepElement.classList.remove('active');
                    stepElement.classList.add('completed');
                } else if (i === currentStep) {
                    stepElement.classList.add('active');
                    stepElement.classList.remove('completed');
                } else {
                    stepElement.classList.remove('active', 'completed');
                }
            }
        }

        // Show current step
        function showStep(step) {
            document.querySelectorAll('.form-step').forEach(step => {
                step.classList.remove('active');
            });
            document.getElementById(`step-${step}`).classList.add('active');
            currentStep = step;
            updateProgressSteps();
        }

        // Show confirmation screen
        function showConfirmation() {
            document.querySelectorAll('.form-step').forEach(step => {
                step.classList.remove('active');
            });
            document.getElementById('confirmation-screen').classList.add('active');
            
            // Hide progress bar
            document.querySelector('.progress-bar').style.display = 'none';
        }

        // Submit application
        function submitApplication() {
            // Get all form values
            const applicationData = {
                firstName: document.getElementById('firstName').value.trim(),
                lastName: document.getElementById('lastName').value.trim(),
                nrc: document.getElementById('nrc').value.trim(),
                phone: document.getElementById('phone').value.trim(),
                email: document.getElementById('email').value.trim(),
                loanAmount: parseFloat(document.getElementById('loanAmount').value),
                loanPurpose: document.getElementById('loanPurpose').value,
                repaymentPeriod: document.querySelector('input[name="repaymentPeriod"]:checked').value,
                address: document.getElementById('address').value.trim(),
                city: document.getElementById('city').value.trim(),
                employmentStatus: document.getElementById('employmentStatus').value,
                employer: document.getElementById('employer').value.trim(),
                monthlyIncome: document.getElementById('monthlyIncome').value ? 
                    parseFloat(document.getElementById('monthlyIncome').value) : 0,
                dueDate: calculateDueDate(document.querySelector('input[name="repaymentPeriod"]:checked').value),
                applicationDate: new Date().toISOString(),
                status: 'Pending',
                timestamp: firebase.database.ServerValue.TIMESTAMP
            };

            // Show loading state
            const submitBtn = document.getElementById('submitBtn');
            const originalText = submitBtn.innerHTML;
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
            submitBtn.disabled = true;

            // Save to Firebase
            const applicationsRef = database.ref('applications');
            applicationsRef.push(applicationData)
                .then(() => {
                    showConfirmation();
                })
                .catch(error => {
                    console.error("Error saving application:", error);
                    showError('loginError', 'Failed to submit application. Please try again.');
                })
                .finally(() => {
                    submitBtn.innerHTML = originalText;
                    submitBtn.disabled = false;
                });
        }

        // Reset form
        function resetForm() {
            document.getElementById('applicationForm').querySelectorAll('input, select, textarea').forEach(element => {
                if (element.type !== 'radio' && element.type !== 'checkbox') {
                    element.value = '';
                } else if (element.type === 'radio' && element.name === 'repaymentPeriod' && element.value === '7') {
                    element.checked = true;
                } else if (element.type === 'checkbox') {
                    element.checked = false;
                }
            });
            
            // Reset to step 1
            showStep(1);
            
            // Show progress bar again
            document.querySelector('.progress-bar').style.display = 'flex';
        }

        // Handle employment status change
        function handleEmploymentStatusChange() {
            const status = document.getElementById('employmentStatus').value;
            const employerGroup = document.getElementById('employerGroup');
            const incomeGroup = document.getElementById('incomeGroup');

            if (status === 'Employed' || status === 'Self-Employed') {
                employerGroup.style.display = 'block';
                incomeGroup.style.display = 'block';
            } else {
                employerGroup.style.display = 'none';
                incomeGroup.style.display = 'none';
            }
        }

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            // Admin login form
            document.getElementById('loginForm').addEventListener('submit', function(e) {
                e.preventDefault();
                
                const username = document.getElementById('adminUsername').value.trim();
                const password = document.getElementById('adminPassword').value.trim();
                
                if (username === ADMIN_USERNAME && password === ADMIN_PASSWORD) {
                    // Redirect to admin dashboard (you would replace this with your actual admin page URL)
                    window.location.href = "index.html";
                } else {
                    showError('loginError', 'Invalid admin credentials');
                }
            });

            // Start application button
            document.getElementById('startApplication').addEventListener('click', function(e) {
                e.preventDefault();
                document.getElementById('loginScreen').style.display = 'none';
                document.getElementById('applicationForm').style.display = 'block';
            });

            // Next button for step 1
            document.getElementById('nextBtn1').addEventListener('click', function() {
                if (validateStep1()) {
                    showStep(2);
                }
            });

            // Previous button for step 2
            document.getElementById('prevBtn2').addEventListener('click', function() {
                showStep(1);
            });

            // Next button for step 2
            document.getElementById('nextBtn2').addEventListener('click', function() {
                if (validateStep2()) {
                    showStep(3);
                }
            });

            // Previous button for step 3
            document.getElementById('prevBtn3').addEventListener('click', function() {
                showStep(2);
            });

            // Next button for step 3
            document.getElementById('nextBtn3').addEventListener('click', function() {
                if (validateStep3()) {
                    showStep(4);
                }
            });

            // Previous button for step 4
            document.getElementById('prevBtn4').addEventListener('click', function() {
                showStep(3);
            });

            // Submit button
            document.getElementById('submitBtn').addEventListener('click', function() {
                if (validateStep4()) {
                    submitApplication();
                }
            });

            // New application button
            document.getElementById('newApplicationBtn').addEventListener('click', function() {
                resetForm();
            });

            // Employment status change
            document.getElementById('employmentStatus').addEventListener('change', handleEmploymentStatusChange);

            // Initialize employment fields visibility
            handleEmploymentStatusChange();

            // Phone number validation
            document.getElementById('phone').addEventListener('input', function(e) {
                this.value = this.value.replace(/[^0-9]/g, '');
            });

            // NRC validation
            document.getElementById('nrc').addEventListener('input', function(e) {
                this.value = this.value.replace(/[^0-9\/]/g, '');
            });

            // Loan amount validation
            document.getElementById('loanAmount').addEventListener('input', function(e) {
                this.value = this.value.replace(/[^0-9.]/g, '');
            });

            // Monthly income validation
            document.getElementById('monthlyIncome').addEventListener('input', function(e) {
                this.value = this.value.replace(/[^0-9.]/g, '');
            });
        });
    </script>
</body>
</html>